# Campaigns Plugin

<!-- Core plugin -- always enabled, cannot be disabled. -->

## Purpose

Manages campaigns (worldbuilding containers). A campaign is the top-level
organizational unit that holds all entities, maps, timelines, etc. Each user
can create multiple campaigns. Campaigns can have members with roles.

## Tier

Plugin (Core -- always enabled)

## Domain Concepts

- **Campaign:** A named worldbuilding project. Contains entities, has settings
  for which modules/plugins are enabled, and owns entity type configurations.
- **Campaign Member:** A user who has access to a campaign with a specific role.
- **Campaign Role:** A permission set (e.g., "GM", "Player", "Co-GM").

## Files

| File | Purpose |
|------|---------|
| handler.go | Campaign CRUD HTTP handlers |
| service.go | Campaign business logic, membership, settings |
| repository.go | Campaign + membership MariaDB queries |
| model.go | Campaign, CampaignMember, CampaignRole models |
| routes.go | Campaign routes (nested under /campaigns) |
| templates/ | Campaign list, show, settings Templ pages |

## Dependencies

- **Uses:** auth (user context), internal/database
- **Used by:** entities, maps, tags, and all campaign-scoped plugins

## Routes

| Method | Path | Handler | Description |
|--------|------|---------|-------------|
| GET | /campaigns | Index | List user's campaigns |
| GET | /campaigns/new | NewForm | Create campaign form |
| POST | /campaigns | Create | Create campaign |
| GET | /campaigns/:id | Show | Campaign dashboard |
| GET | /campaigns/:id/edit | EditForm | Edit form |
| PUT | /campaigns/:id | Update | Update campaign |
| DELETE | /campaigns/:id | Delete | Delete campaign |
| GET | /campaigns/:id/settings | Settings | Campaign settings |

## Business Rules

- Campaign names must be non-empty
- Slug auto-generated from name, must be unique globally
- Only the creator (or campaign admin) can delete a campaign
- Deleting a campaign cascades to all entities, maps, etc.
- Campaign settings JSON stores which modules/plugins are enabled

## Current State

- [ ] .ai.md created
- [ ] Handler scaffolded
- [ ] Service implemented
- [ ] Repository implemented
- [ ] Templates created
- [ ] Tests written
- [ ] Integrated with main router

## Notes

- Campaign membership and roles are Phase 3 features.
- For Phase 1, campaigns are single-user (creator only).
