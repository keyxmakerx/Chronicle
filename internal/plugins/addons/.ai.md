# Addons Plugin

## Purpose
Manages the extension framework — installable addons (modules, widgets, integrations)
with per-campaign enable/disable controls. Admin manages the global addon registry;
campaign owners toggle addons per campaign.

## Architecture
Standard plugin: handler → service → repository → MariaDB.

### Files
- `model.go` — Domain types: Addon, CampaignAddon, AddonCategory/Status, DTOs.
- `repository.go` — SQL CRUD for addons + campaign_addons tables.
- `service.go` — Business logic: validation, status checks, campaign enable/disable.
- `handler.go` — HTTP handlers for admin pages + campaign-scoped toggle API.
- `routes.go` — Route registration: admin routes + campaign-scoped routes.
- `admin_addons.templ` — Admin addon management page.
- `campaign_addons.templ` — Per-campaign addon toggle page.

### Database Tables
- `addons` — Global addon registry (id, slug, name, category, status, icon, etc.)
- `campaign_addons` — Per-campaign addon state (campaign_id, addon_id, enabled, config_json)

### Routes

**Admin (site admin only):**
- `GET /admin/addons` — Addon management page
- `POST /admin/addons` — Register new addon
- `PUT /admin/addons/:addonID/status` — Change addon status
- `DELETE /admin/addons/:addonID` — Delete addon

**Campaign (campaign owner only):**
- `GET /campaigns/:id/addons/settings` — Campaign addon settings page
- `GET /campaigns/:id/addons` — JSON list of addons with campaign state
- `PUT /campaigns/:id/addons/:addonID/toggle` — Enable/disable addon

## Dependencies
- `campaigns` — For campaign context middleware and role checks.
- `auth` — For authentication and admin middleware.
- `apperror` — For domain error types.

## Key Decisions
- Addons start as "planned" when created, must be set to "active" to be enableable.
- Disabling an addon doesn't delete config — re-enabling preserves previous settings.
- The addon system is read-only at the campaign level (addons can't modify their config yet,
  this will come with the Sync API plugin).
