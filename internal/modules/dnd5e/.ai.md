# D&D 5e Module

## Purpose

Provides Dungeons & Dragons 5th Edition SRD reference content. Serves spell
descriptions, monster stat blocks, item properties, class features, and other
SRD-licensed content as tooltips (on @mention hover) and dedicated reference
pages.

## Tier

Module (Game System -- optional, enabled per campaign)

## Domain Concepts

- **SRD Content:** System Reference Document content that is freely available
  under the Open Game License. We can ONLY include SRD content, not proprietary.
- **Tooltip:** A small HTML fragment shown on hover when a user @mentions a
  game reference (e.g., `@spell:fireball` shows damage, range, components).
- **Reference Page:** A full page showing complete details for a spell, monster,
  item, etc.

## Files

| File | Purpose |
|------|---------|
| handler.go | Serves reference pages and tooltip API |
| data/ | Static JSON files with SRD content |
| routes.go | Route registration under /ref/dnd5e/ |
| templates/ | Reference page and tooltip Templ components |

## Dependencies

- **Uses:** Nothing (read-only, self-contained)
- **Used by:** widgets/mentions (tooltip API), entity pages (reference links)

## Routes

| Method | Path | Handler | Description |
|--------|------|---------|-------------|
| GET | /ref/dnd5e/ | Index | Reference index |
| GET | /ref/dnd5e/spells | SpellList | All SRD spells |
| GET | /ref/dnd5e/spells/:slug | SpellShow | Single spell page |
| GET | /ref/dnd5e/monsters | MonsterList | All SRD monsters |
| GET | /ref/dnd5e/monsters/:slug | MonsterShow | Single monster page |
| GET | /api/v1/ref/dnd5e/lookup | Lookup | Tooltip API (?q=fireball) |

## Business Rules

- **Read-only.** This module NEVER writes to the database.
- Only SRD/OGL content. No proprietary D&D content.
- Tooltip API returns HTML fragments for hover previews.
- Reference pages are server-rendered (Templ + HTMX).
- Data files are loaded once at startup and cached in memory.

## Current State

- [ ] .ai.md created
- [ ] Handler scaffolded
- [ ] SRD data files collected
- [ ] Routes registered
- [ ] Tooltip template
- [ ] Reference page templates
- [ ] Integrated with mention system

## Notes

- SRD content can be sourced from the official 5e SRD or open community APIs.
- This is a Phase 2+ feature. Not needed for Phase 1.
- Other modules (pathfinder, drawsteel) will follow the same pattern.
