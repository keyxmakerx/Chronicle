# Notes Widget

## Purpose
Floating personal note-taking panel (Google Keep-style) that appears in the
bottom-right corner of campaign pages. Each user has their own private notes
within a campaign, optionally scoped to specific entities (pages).

## Architecture
- **Tier:** Widget (with full backend)
- **Addon slug:** `player-notes` (disabled by default, owner enables per-campaign)
- **Backend:** handler → service → repository → MariaDB `notes` table
- **Frontend:** `static/js/widgets/notes.js` — self-contained floating panel

## Data Model
- `notes` table: per-user, per-campaign, optional entity_id scoping
- Content is a JSON array of blocks: `[{type: "text", value: "..."}, {type: "checklist", items: [...]}]`
- Pinned notes sort first, then by updated_at DESC

## Key Features
- **Page-specific notes:** When viewing an entity, shows notes for that page
- **Campaign-wide notes:** General notes not tied to any entity
- **Checklists:** Interactive checkboxes with toggle API
- **Collapsible panel:** Minimizes to a small button, expands on click
- **Color coding:** Notes can have a color accent

## Routes
All under `/campaigns/:id/notes`:
- `GET /` — List notes (scope=all|campaign|entity, entity_id=...)
- `POST /` — Create note
- `PUT /:noteId` — Update note
- `DELETE /:noteId` — Delete note
- `POST /:noteId/toggle` — Toggle checklist item

## Frontend Widget
Registered as `Chronicle.register('notes', ...)`. Mounted via
`<div data-widget="notes" data-campaign-id="..." data-entity-id="...">` in the
app layout. The widget renders a fixed-position panel in the bottom-right.
